<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"/>
<title>Monsieur</title>
<link rel="preconnect" href="https://fonts.googleapis.com"/>
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin/>
<link href="https://fonts.googleapis.com/css2?family=Bodoni+Moda:ital,opsz,wght@0,6..96,400;0,6..96,700;1,6..96,400&family=EB+Garamond:ital,wght@0,300;0,400;1,300;1,400&family=Jost:wght@200;300;400;500&display=swap" rel="stylesheet"/>
<script src="https://telegram.org/js/telegram-web-app.js"></script>
<style>
:root{
  --void:#060504;--deep:#0d0b09;--card:#1c1814;--card2:#221e19;
  --gold:#c8a45a;--gold2:#e2c07a;--gold3:#f5dda0;
  --ember:#d4621a;--cream:#f2e8d8;--fog:#8a7f72;
  --rim:rgba(200,164,90,.18);--rim2:rgba(200,164,90,.07);
  --green:#4caf82;--r:14px;
}
*{margin:0;padding:0;box-sizing:border-box;-webkit-tap-highlight-color:transparent}
html,body{background:var(--void);color:var(--cream);font-family:'Jost',sans-serif;font-weight:300;min-height:100vh;overflow-x:hidden}
body::before{content:'';position:fixed;inset:0;background-image:url("data:image/svg+xml,%3Csvg viewBox='0 0 200 200' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.85' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23n)' opacity='0.05'/%3E%3C/svg%3E");pointer-events:none;z-index:9999;opacity:.55;animation:grain .5s steps(2) infinite;}
@keyframes grain{0%{transform:translate(0,0)}25%{transform:translate(-1px,1px)}75%{transform:translate(1px,-1px)}}

/* HERO */
.hero{position:relative;height:290px;overflow:hidden;display:flex;flex-direction:column;align-items:center;justify-content:flex-end;padding-bottom:34px}
.hero-bg{position:absolute;inset:-5%;background:url('https://images.unsplash.com/photo-1414235077428-338989a2e8c0?w=900&q=85') center/cover no-repeat;animation:breath 20s ease-in-out infinite alternate;}
@keyframes breath{0%{transform:scale(1.12)}100%{transform:scale(1) translateY(-2%)}}
.hero-bg::after{content:'';position:absolute;inset:0;background:linear-gradient(180deg,rgba(6,5,4,.15) 0%,rgba(6,5,4,.6) 55%,rgba(6,5,4,1) 100%);}
.orb{position:absolute;border-radius:50%;filter:blur(50px);pointer-events:none;}
.orb1{width:200px;height:200px;background:radial-gradient(circle,rgba(200,164,90,.2),transparent 70%);top:-50px;left:-30px;animation:o1 15s ease-in-out infinite alternate;}
.orb2{width:130px;height:130px;background:radial-gradient(circle,rgba(212,98,26,.14),transparent 70%);top:5px;right:-5px;animation:o2 11s ease-in-out infinite alternate;}
@keyframes o1{to{transform:translate(25px,18px) scale(1.1)}}
@keyframes o2{to{transform:translate(-18px,22px)}}
.hero-content{position:relative;z-index:2;text-align:center}
.hero-eyebrow{font-size:9px;letter-spacing:5px;text-transform:uppercase;color:var(--gold);margin-bottom:10px;animation:fadeUp .9s .15s both;}
.hero-title{font-family:'Bodoni Moda',serif;font-size:54px;font-weight:700;letter-spacing:3px;line-height:.92;background:linear-gradient(160deg,#fff 20%,var(--gold2) 55%,var(--gold3));-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text;animation:titleIn .9s .3s both;filter:drop-shadow(0 0 30px rgba(200,164,90,.25));}
@keyframes titleIn{from{opacity:0;transform:translateY(18px) scale(.97)}}
.hero-sub{font-family:'EB Garamond',serif;font-style:italic;font-size:17px;color:var(--gold);margin-top:8px;letter-spacing:2px;animation:fadeUp .9s .5s both;}
.hero-orn{display:flex;align-items:center;justify-content:center;gap:12px;margin-top:12px;animation:fadeUp .9s .65s both;}
.hero-orn::before,.hero-orn::after{content:'';flex:1;max-width:32px;height:1px;}
.hero-orn::before{background:linear-gradient(90deg,transparent,var(--gold));}
.hero-orn::after{background:linear-gradient(90deg,var(--gold),transparent);}
.hero-orn span{font-size:10px;color:var(--gold)}

/* NAV */
.nav{display:flex;background:rgba(13,11,9,.93);border-bottom:1px solid var(--rim2);position:sticky;top:0;z-index:100;backdrop-filter:blur(20px);}
.nav-btn{flex:1;padding:14px 2px;background:none;border:none;color:var(--fog);font-family:'Jost',sans-serif;font-size:9px;letter-spacing:1.8px;text-transform:uppercase;cursor:pointer;position:relative;transition:color .3s;}
.nav-btn.active{color:var(--gold)}
.nav-btn.active::before{content:'';position:absolute;inset:0;background:linear-gradient(180deg,transparent,rgba(200,164,90,.04));pointer-events:none;}
.nav-glow{position:absolute;bottom:0;height:1px;background:linear-gradient(90deg,transparent,var(--gold),transparent);transition:left .4s cubic-bezier(.77,0,.18,1),width .4s cubic-bezier(.77,0,.18,1);pointer-events:none;}

/* PAGES */
.page{display:none;padding-bottom:110px}
.page.active{display:block;animation:pageIn .4s cubic-bezier(.25,.1,.25,1)}
@keyframes pageIn{from{opacity:0;transform:translateY(8px)}}

/* SECTION */
.s-head{padding:24px 20px 0}
.s-title{font-family:'Bodoni Moda',serif;font-size:26px;font-weight:400;line-height:1}
.s-title em{color:var(--gold);font-style:normal}
.s-rule{height:1px;margin:10px 20px 0;background:linear-gradient(90deg,rgba(200,164,90,.4),transparent);}

/* CATEGORIES */
.cat-wrap{padding:16px 20px 12px;overflow-x:auto;scrollbar-width:none;display:flex;gap:8px}
.cat-wrap::-webkit-scrollbar{display:none}
.cat-pill{flex-shrink:0;padding:8px 18px;border-radius:30px;border:1px solid var(--rim2);background:none;color:var(--fog);font-family:'Jost',sans-serif;font-size:11px;letter-spacing:1.5px;text-transform:uppercase;cursor:pointer;transition:all .25s;white-space:nowrap;position:relative;overflow:hidden;}
.cat-pill::before{content:'';position:absolute;inset:0;background:linear-gradient(135deg,var(--gold),var(--gold2));opacity:0;transition:opacity .25s;}
.cat-pill span{position:relative;z-index:1}
.cat-pill.active{border-color:var(--gold);color:var(--void);}
.cat-pill.active::before{opacity:1}

/* MENU SKELETON */
.skeleton-list{padding:0 16px;display:flex;flex-direction:column;gap:10px}
.skeleton-card{height:108px;background:var(--card);border-radius:var(--r);overflow:hidden;position:relative;}
.skeleton-card::after{content:'';position:absolute;inset:0;background:linear-gradient(90deg,transparent,rgba(255,255,255,.04),transparent);animation:shimmer 1.4s infinite;}
@keyframes shimmer{from{transform:translateX(-100%)}to{transform:translateX(100%)}}

/* MENU CARDS */
.menu-grid{padding:0 16px;display:flex;flex-direction:column;gap:10px}
.mcard{display:flex;background:var(--card);border:1px solid var(--rim2);border-radius:var(--r);overflow:hidden;position:relative;opacity:0;transform:translateY(16px) scale(.99);}
.mcard.in{animation:cardIn .45s cubic-bezier(.34,1.1,.64,1) forwards}
@keyframes cardIn{to{opacity:1;transform:none}}
.mcard:active{transform:scale(.985)!important;transition:transform .1s}
.mcard-img-wrap{position:relative;width:105px;flex-shrink:0;overflow:hidden;background:var(--card2);}
.mcard-img{width:100%;height:100%;object-fit:cover;min-height:108px;display:block;transition:transform .55s,opacity .3s;opacity:0;}
.mcard-img.loaded{opacity:1}
.mcard:hover .mcard-img{transform:scale(1.07)}
.mcard-img-overlay{position:absolute;inset:0;background:linear-gradient(90deg,transparent 55%,var(--card));}
.mcard-body{flex:1;padding:13px 13px 13px 2px;display:flex;flex-direction:column;justify-content:space-between;}
.mcard-name{font-family:'Bodoni Moda',serif;font-size:15px;line-height:1.2;margin-bottom:3px;}
.mcard-desc{font-family:'EB Garamond',serif;font-style:italic;font-size:13px;color:var(--fog);line-height:1.35;flex:1;}
.mcard-foot{display:flex;align-items:center;justify-content:space-between;margin-top:9px;}
.mcard-price{font-size:14px;font-weight:400;background:linear-gradient(135deg,var(--gold),var(--gold2));-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text;}
.add-btn{width:32px;height:32px;border-radius:50%;border:1.5px solid var(--gold);background:none;color:var(--gold);font-size:22px;display:flex;align-items:center;justify-content:center;cursor:pointer;transition:all .2s;position:relative;overflow:hidden;}
.add-btn::before{content:'';position:absolute;inset:0;background:var(--gold);border-radius:50%;transform:scale(0);transition:transform .3s cubic-bezier(.34,1.4,.64,1);}
.add-btn:active::before{transform:scale(1)}
.add-btn .plus{position:relative;z-index:1;pointer-events:none;line-height:1;}
.add-btn:active .plus{color:var(--void)}
.qty-ctrl{display:flex;align-items:center;gap:6px}
.qty-btn{width:28px;height:28px;border-radius:50%;border:1px solid var(--rim);background:none;color:var(--cream);font-size:16px;display:flex;align-items:center;justify-content:center;cursor:pointer;transition:all .2s;}
.qty-btn:active{border-color:var(--gold);color:var(--gold);transform:scale(.88)}
.qty-num{font-size:14px;font-weight:500;min-width:18px;text-align:center;}
.qty-num.bump{animation:bump .22s ease}
@keyframes bump{50%{transform:scale(1.45)}}
.cart-badge{display:inline-flex;align-items:center;justify-content:center;background:linear-gradient(135deg,var(--gold),var(--gold2));color:var(--void);border-radius:10px;padding:1px 7px;font-size:10px;font-weight:700;margin-left:5px;vertical-align:middle;}
.cart-badge.pop{animation:badgePop .3s cubic-bezier(.34,1.6,.64,1)}
@keyframes badgePop{from{transform:scale(0)}}

/* BOOKING */
.book-form{padding:4px 20px;display:flex;flex-direction:column;gap:20px}
.f-group{display:flex;flex-direction:column;gap:8px}
.f-label{font-size:9px;letter-spacing:3px;text-transform:uppercase;color:var(--gold);}
.f-input,.f-textarea{background:var(--card);border:1px solid var(--rim2);border-radius:12px;padding:13px 16px;color:var(--cream);font-family:'Jost',sans-serif;font-size:15px;font-weight:300;outline:none;transition:border-color .25s,box-shadow .25s,background .25s;width:100%;-webkit-appearance:none;appearance:none;}
.f-input:focus,.f-textarea:focus{border-color:rgba(200,164,90,.5);box-shadow:0 0 0 3px rgba(200,164,90,.07);background:var(--card2);}
.f-input::placeholder{color:var(--fog)}
.f-textarea{resize:none}
.phone-wrap{position:relative}
.phone-prefix{position:absolute;left:16px;top:50%;transform:translateY(-50%);color:var(--cream);font-size:15px;pointer-events:none;}
.phone-input{padding-left:40px!important}
.time-grid{display:grid;grid-template-columns:repeat(4,1fr);gap:7px}
.t-btn{padding:10px 0;border:1px solid var(--rim2);border-radius:12px;background:none;color:var(--fog);font-family:'Jost',sans-serif;font-size:13px;cursor:pointer;transition:all .25s;}
.t-btn .tt{display:block;font-size:13px;}
.t-btn .ts{display:block;font-size:8px;letter-spacing:1px;text-transform:uppercase;margin-top:2px;}
.t-btn.free:hover{border-color:rgba(200,164,90,.3);color:var(--cream)}
.t-btn.sel{background:linear-gradient(135deg,rgba(200,164,90,.15),rgba(200,164,90,.05));border-color:var(--gold);color:var(--gold);}
.t-btn.sel .ts{color:var(--gold)}
.t-btn.busy{opacity:.38;cursor:not-allowed;background:repeating-linear-gradient(-45deg,transparent,transparent 5px,rgba(255,255,255,.01) 5px,rgba(255,255,255,.01) 10px);}
.t-btn.busy .ts{color:var(--ember)}
.guest-grid{display:grid;grid-template-columns:repeat(6,1fr);gap:6px}
.g-btn{padding:12px 0;border:1px solid var(--rim2);border-radius:12px;background:none;color:var(--fog);font-family:'Jost',sans-serif;font-size:15px;cursor:pointer;transition:all .22s;}
.g-btn.active{background:linear-gradient(135deg,var(--gold),var(--gold2));border-color:transparent;color:var(--void);font-weight:500;}
.cta-btn{width:100%;padding:17px;background:linear-gradient(110deg,var(--gold) 0%,var(--gold2) 40%,var(--gold3) 70%,var(--gold2) 100%);background-size:300% 100%;border:none;border-radius:14px;color:var(--void);font-family:'Bodoni Moda',serif;font-size:17px;font-weight:700;letter-spacing:.5px;cursor:pointer;position:relative;overflow:hidden;transition:transform .15s;animation:btnShine 4s linear infinite;}
@keyframes btnShine{0%{background-position:100% 0}100%{background-position:-100% 0}}
.cta-btn:active{transform:scale(.98)}
.cta-btn:disabled{opacity:.35;pointer-events:none;animation:none}
.cta-btn::after{content:'';position:absolute;top:0;left:-100%;width:50%;height:100%;background:linear-gradient(90deg,transparent,rgba(255,255,255,.28),transparent);animation:glint 4s ease infinite 2s;}
@keyframes glint{0%,100%{left:-100%}50%{left:150%}}
.rpl{position:absolute;border-radius:50%;background:rgba(255,255,255,.35);transform:scale(0);animation:rplAnim .55s linear;pointer-events:none;}
@keyframes rplAnim{to{transform:scale(4);opacity:0}}

/* ORDER */
.order-list{padding:0 16px;display:flex;flex-direction:column;gap:8px}
.oitem{display:flex;align-items:center;gap:11px;background:var(--card);border:1px solid var(--rim2);border-radius:12px;padding:11px 13px;animation:slideIn .3s ease;}
@keyframes slideIn{from{opacity:0;transform:translateX(-10px)}}
.oitem-img{width:46px;height:46px;border-radius:8px;object-fit:cover}
.oitem-name{font-family:'Bodoni Moda',serif;font-size:14px}
.oitem-qty{font-size:11px;color:var(--fog);margin-top:2px}
.oitem-price{font-size:13px;font-weight:400;background:linear-gradient(135deg,var(--gold),var(--gold2));-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text;margin-left:auto;}
.order-summary{margin:13px 20px 0;background:var(--card);border:1px solid var(--rim2);border-radius:14px;padding:17px;}
.sum-row{display:flex;justify-content:space-between;font-size:13px;color:var(--fog);padding:3px 0}
.sum-row.total{font-family:'Bodoni Moda',serif;font-size:18px;color:var(--cream);border-top:1px solid var(--rim);margin-top:10px;padding-top:13px}
.sum-row.total span:last-child{background:linear-gradient(135deg,var(--gold),var(--gold2));-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text;}
.empty-state{text-align:center;padding:65px 20px;animation:fadeUp .5s ease}
.empty-icon{font-size:48px;margin-bottom:13px}
.empty-txt{font-family:'EB Garamond',serif;font-style:italic;font-size:18px;color:var(--fog);line-height:1.6}

/* MY BOOKINGS */
.my-bookings-wrap{padding:4px 20px}
.phone-search{display:flex;flex-direction:column;gap:12px;margin-bottom:24px;background:var(--card);border:1px solid var(--rim2);border-radius:16px;padding:20px;}
.search-hint{font-family:'EB Garamond',serif;font-style:italic;font-size:15px;color:var(--fog);line-height:1.5;margin-bottom:4px;}
.b-card{background:var(--card);border:1px solid var(--rim2);border-radius:14px;padding:18px;margin-bottom:10px;animation:fadeUp .4s ease;}
.b-card.cancelled{opacity:.5;border-style:dashed;}
.b-card-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:12px;}
.b-card-id{font-family:'Bodoni Moda',serif;font-size:16px;}
.b-status{font-size:11px;padding:4px 10px;border-radius:20px;font-weight:500;}
.b-status.confirmed{background:rgba(76,175,130,.15);color:var(--green);}
.b-status.cancelled{background:rgba(212,98,26,.12);color:var(--ember);}
.b-row{display:flex;gap:8px;align-items:center;margin-bottom:6px;font-size:14px;}
.b-row-icon{font-size:14px;width:20px;flex-shrink:0;}
.b-comment{font-family:'EB Garamond',serif;font-style:italic;font-size:13px;color:var(--fog);margin-top:6px;}
.cancel-btn{width:100%;margin-top:14px;padding:12px;background:rgba(212,98,26,.12);border:1px solid rgba(212,98,26,.3);border-radius:12px;color:var(--ember);font-family:'Jost',sans-serif;font-size:13px;font-weight:500;letter-spacing:.5px;cursor:pointer;transition:all .2s;}
.cancel-btn:active{background:rgba(212,98,26,.25)}

/* ABOUT */
.about-wrap{padding:4px 20px}
.about-img-wrap{position:relative;height:190px;border-radius:16px;overflow:hidden;margin-bottom:18px;}
.about-img{width:100%;height:100%;object-fit:cover;transition:transform .6s}
.about-img-wrap:hover .about-img{transform:scale(1.04)}
.about-img-wrap::after{content:'';position:absolute;inset:0;background:linear-gradient(180deg,transparent 40%,rgba(6,5,4,.65));}
.about-txt{font-family:'EB Garamond',serif;font-size:17px;line-height:1.75;color:#c2b8ad;margin-bottom:16px}
.info-list{display:flex;flex-direction:column;gap:8px}
.info-item{display:flex;align-items:center;gap:13px;background:var(--card);border:1px solid var(--rim2);border-radius:12px;padding:14px 16px;transition:border-color .25s,background .25s;text-decoration:none;color:inherit;}
.info-item:hover{border-color:var(--rim);background:var(--card2)}
.info-item:active{transform:scale(.98)}
.info-icon{font-size:20px;width:26px;text-align:center;flex-shrink:0}
.info-lbl{font-size:9px;letter-spacing:2.5px;text-transform:uppercase;color:var(--gold)}
.info-val{font-size:14px;margin-top:3px}
.info-arrow{margin-left:auto;color:var(--fog);font-size:12px;opacity:.5}

/* MAPS MODAL */
.modal-overlay{display:none;position:fixed;inset:0;background:rgba(6,5,4,.88);z-index:600;align-items:flex-end;justify-content:center;}
.modal-overlay.show{display:flex}
.modal-box{background:var(--card2);border-radius:20px 20px 0 0;padding:24px 20px 44px;width:100%;max-width:500px;animation:slideUpM .3s cubic-bezier(.34,1.1,.64,1)}
@keyframes slideUpM{from{transform:translateY(100%)}}
.modal-title{font-family:'Bodoni Moda',serif;font-size:19px;margin-bottom:5px}
.modal-sub{font-size:13px;color:var(--fog);margin-bottom:20px}
.modal-btns{display:flex;flex-direction:column;gap:10px}
.map-btn{display:block;text-align:center;text-decoration:none;padding:14px;border-radius:14px;font-family:'Bodoni Moda',serif;font-size:15px;font-weight:700;cursor:pointer;border:none;}
.map-btn.yandex{background:linear-gradient(135deg,#fc4c4e,#fd6060);color:#fff;}
.map-btn.google{background:linear-gradient(135deg,#4285F4,#34A853);color:#fff;}
.modal-cancel{padding:12px;background:none;border:1px solid var(--rim);border-radius:12px;color:var(--fog);font-family:'Jost',sans-serif;font-size:14px;cursor:pointer;width:100%;}

/* TOAST */
.toast{position:fixed;bottom:88px;left:50%;transform:translateX(-50%) translateY(10px);background:var(--card2);border:1px solid var(--rim);color:var(--cream);padding:10px 22px;border-radius:30px;font-size:13px;opacity:0;z-index:1000;transition:all .35s cubic-bezier(.34,1.3,.64,1);pointer-events:none;white-space:nowrap;}
.toast.show{opacity:1;transform:translateX(-50%) translateY(0)}

/* SUCCESS */
.success-overlay{display:none;position:fixed;inset:0;background:rgba(6,5,4,.97);z-index:500;flex-direction:column;align-items:center;justify-content:center;text-align:center;padding:40px;}
.success-overlay.show{display:flex;animation:overlayIn .45s cubic-bezier(.34,1.1,.64,1)}
@keyframes overlayIn{from{opacity:0;transform:scale(.93)}}
.sparks{position:absolute;inset:0;pointer-events:none;overflow:hidden}
.spark{position:absolute;border-radius:50%;animation:sparkFly var(--dur,1s) var(--del,0s) ease-out both;}
@keyframes sparkFly{0%{transform:translate(0,0) scale(1);opacity:1}100%{transform:translate(var(--tx),var(--ty)) scale(0);opacity:0}}
.s-rings{position:relative;width:96px;height:96px;margin-bottom:22px}
.s-ring{position:absolute;border-radius:50%;border:1px solid;animation:ringExp 1.5s ease-out infinite;}
.s-ring:nth-child(1){inset:0;border-color:rgba(200,164,90,.6);animation-delay:0s}
.s-ring:nth-child(2){inset:-11px;border-color:rgba(200,164,90,.3);animation-delay:.3s}
.s-ring:nth-child(3){inset:-22px;border-color:rgba(200,164,90,.1);animation-delay:.6s}
@keyframes ringExp{0%{transform:scale(.5);opacity:1}100%{transform:scale(1.3);opacity:0}}
.s-center{position:absolute;inset:0;display:flex;align-items:center;justify-content:center;font-size:36px;animation:iconDrop .5s .15s cubic-bezier(.34,1.5,.64,1) both}
@keyframes iconDrop{from{transform:scale(0) rotate(-30deg);opacity:0}}
.s-title{font-family:'Bodoni Moda',serif;font-size:30px;font-weight:700;background:linear-gradient(135deg,var(--gold),var(--gold3));-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text;margin-bottom:11px;animation:fadeUp .45s .3s both;}
.s-text{font-family:'EB Garamond',serif;font-style:italic;font-size:16px;color:var(--fog);line-height:1.75;margin-bottom:30px;white-space:pre-line;animation:fadeUp .45s .4s both;}
.s-cta{width:100%;max-width:285px;animation:fadeUp .45s .5s both}

/* LOADER */
.loader{display:flex;justify-content:center;align-items:center;padding:50px;gap:6px;}
.loader-dot{width:6px;height:6px;border-radius:50%;background:var(--gold);animation:loaderBounce .8s ease-in-out infinite alternate;}
.loader-dot:nth-child(2){animation-delay:.15s}
.loader-dot:nth-child(3){animation-delay:.3s}
@keyframes loaderBounce{from{transform:translateY(0);opacity:.4}to{transform:translateY(-10px);opacity:1}}

@keyframes fadeUp{from{opacity:0;transform:translateY(14px)}to{opacity:1;transform:none}}
.pb{height:24px}
</style>
</head>
<body>

<!-- HERO -->
<div class="hero">
  <div class="hero-bg"></div>
  <div class="orb orb1"></div>
  <div class="orb orb2"></div>
  <div class="hero-content">
    <div class="hero-eyebrow">Fine Dining ¬∑ –ú–æ—Å–∫–≤–∞</div>
    <h1 class="hero-title">Monsieur</h1>
    <p class="hero-sub">cuisine fran√ßaise</p>
    <div class="hero-orn"><span>‚ú¶</span></div>
  </div>
</div>

<!-- NAV -->
<nav class="nav" id="nav">
  <button class="nav-btn active" data-page="menu">–ú–µ–Ω—é</button>
  <button class="nav-btn" data-page="booking">–ë—Ä–æ–Ω—å</button>
  <button class="nav-btn" data-page="order">–ó–∞–∫–∞–∑ <span class="cart-badge" id="cartBadge" style="display:none">0</span></button>
  <button class="nav-btn" data-page="mybookings">–ú–æ–∏ –±—Ä–æ–Ω–∏</button>
  <button class="nav-btn" data-page="about">–û –Ω–∞—Å</button>
  <div class="nav-glow" id="navGlow"></div>
</nav>

<!-- ‚ïê‚ïê MENU ‚ïê‚ïê -->
<div id="page-menu" class="page active">
  <div class="s-head"><div class="s-title">–ù–∞—à–µ <em>–º–µ–Ω—é</em></div></div>
  <div class="s-rule"></div>
  <div class="cat-wrap" id="catWrap"></div>
  <div id="menuContent">
    <div class="skeleton-list">
      <div class="skeleton-card"></div>
      <div class="skeleton-card"></div>
      <div class="skeleton-card"></div>
    </div>
  </div>
  <div class="pb"></div>
</div>

<!-- ‚ïê‚ïê BOOKING ‚ïê‚ïê -->
<div id="page-booking" class="page">
  <div class="s-head"><div class="s-title">–ó–∞–±—Ä–æ–Ω–∏—Ä–æ–≤–∞—Ç—å <em>—Å—Ç–æ–ª–∏–∫</em></div></div>
  <div class="s-rule"></div>
  <div style="height:18px"></div>
  <div class="book-form">
    <div class="f-group">
      <label class="f-label">–í–∞—à–µ –∏–º—è</label>
      <input id="bName" type="text" class="f-input" placeholder="–ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤" autocomplete="name"/>
    </div>
    <div class="f-group">
      <label class="f-label">–¢–µ–ª–µ—Ñ–æ–Ω</label>
      <div class="phone-wrap">
        <span class="phone-prefix">+7</span>
        <input id="bPhone" type="tel" class="f-input phone-input" placeholder="(900) 000-00-00" maxlength="15" inputmode="numeric"/>
      </div>
    </div>
    <div class="f-group">
      <label class="f-label">–î–∞—Ç–∞</label>
      <input id="bDate" type="date" class="f-input"/>
    </div>
    <div class="f-group">
      <label class="f-label">–í—Ä–µ–º—è</label>
      <div class="time-grid" id="timeGrid"><div class="loader"><div class="loader-dot"></div><div class="loader-dot"></div><div class="loader-dot"></div></div></div>
    </div>
    <div class="f-group">
      <label class="f-label">–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –≥–æ—Å—Ç–µ–π</label>
      <div class="guest-grid" id="guestGrid"></div>
    </div>
    <div class="f-group">
      <label class="f-label">–ü–æ–∂–µ–ª–∞–Ω–∏—è</label>
      <textarea id="bComment" class="f-textarea" rows="3" placeholder="–¢–∏—Ö–∏–π —É–≥–æ–ª, –≤–∏–¥ –Ω–∞ –∑–∞–ª, –¥–µ—Ç—Å–∫–æ–µ –∫—Ä–µ—Å–ª–æ‚Ä¶"></textarea>
    </div>
    <button class="cta-btn" onclick="submitBooking(event)">–ó–∞–±—Ä–æ–Ω–∏—Ä–æ–≤–∞—Ç—å</button>
  </div>
  <div class="pb"></div>
</div>

<!-- ‚ïê‚ïê ORDER ‚ïê‚ïê -->
<div id="page-order" class="page">
  <div class="s-head"><div class="s-title">–í–∞—à <em>–∑–∞–∫–∞–∑</em></div></div>
  <div class="s-rule"></div>
  <div style="height:16px"></div>
  <div id="orderContent"></div>
  <div class="pb"></div>
</div>

<!-- ‚ïê‚ïê MY BOOKINGS ‚ïê‚ïê -->
<div id="page-mybookings" class="page">
  <div class="s-head"><div class="s-title">–ú–æ–∏ <em>–±—Ä–æ–Ω–∏</em></div></div>
  <div class="s-rule"></div>
  <div style="height:18px"></div>
  <div class="my-bookings-wrap">
    <div class="phone-search">
      <div class="search-hint">–í–≤–µ–¥–∏—Ç–µ –Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞, —É–∫–∞–∑–∞–Ω–Ω—ã–π –ø—Ä–∏ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–∏</div>
      <div class="phone-wrap">
        <span class="phone-prefix">+7</span>
        <input id="searchPhone" type="tel" class="f-input phone-input" placeholder="(900) 000-00-00" maxlength="15" inputmode="numeric"/>
      </div>
      <button class="cta-btn" onclick="searchBookings(event)">–ù–∞–π—Ç–∏ –±—Ä–æ–Ω–∏</button>
    </div>
    <div id="bookingResults"></div>
  </div>
  <div class="pb"></div>
</div>

<!-- ‚ïê‚ïê ABOUT ‚ïê‚ïê -->
<div id="page-about" class="page">
  <div class="s-head"><div class="s-title">–û <em>—Ä–µ—Å—Ç–æ—Ä–∞–Ω–µ</em></div></div>
  <div class="s-rule"></div>
  <div style="height:18px"></div>
  <div class="about-wrap">
    <div class="about-img-wrap">
      <img class="about-img" src="https://images.unsplash.com/photo-1559339352-11d035aa65de?w=800&q=80" alt="–ó–∞–ª"/>
    </div>
    <p class="about-txt">Monsieur ‚Äî —ç—Ç–æ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ, –≥–¥–µ –∫–∞–∂–¥–æ–µ –±–ª—é–¥–æ —Ä–∞—Å—Å–∫–∞–∑—ã–≤–∞–µ—Ç –∏—Å—Ç–æ—Ä–∏—é. –í–¥–æ—Ö–Ω–æ–≤–ª—ë–Ω–Ω—ã–µ —Ç—Ä–∞–¥–∏—Ü–∏–µ–π —Ñ—Ä–∞–Ω—Ü—É–∑—Å–∫–æ–π –∫—É—Ö–Ω–∏, –º—ã —Å–æ–∑–¥–∞—ë–º –≤–µ—á–µ—Ä–∞, –∫–æ—Ç–æ—Ä—ã–µ –æ—Å—Ç–∞—é—Ç—Å—è –≤ –ø–∞–º—è—Ç–∏ –Ω–∞–≤—Å–µ–≥–¥–∞.</p>
    <p class="about-txt">–®–µ—Ñ –ü—å–µ—Ä –õ–µ—Ñ–µ–≤—Ä —Å–æ–±—Ä–∞–ª –∫–æ–º–∞–Ω–¥—É –∏–∑ –ª—É—á—à–∏—Ö –∫—É–ª–∏–Ω–∞—Ä–æ–≤ –ï–≤—Ä–æ–ø—ã. –ü—Ä–æ–¥—É–∫—Ç—ã –ø–æ—Å—Ç–∞–≤–ª—è—é—Ç—Å—è —Å —Ñ–µ—Ä–º –ü—Ä–æ–≤–∞–Ω—Å–∞ –∏ –ë—É—Ä–≥—É–Ω–¥–∏–∏.</p>
    <div class="info-list">
      <a class="info-item" href="#" onclick="openMaps(event)">
        <div class="info-icon">üìç</div>
        <div><div class="info-lbl">–ê–¥—Ä–µ—Å</div><div class="info-val">–ú–æ—Å–∫–≤–∞, —É–ª. –ö—É–∑–Ω–µ—Ü–∫–∏–π –ú–æ—Å—Ç, 7</div></div>
        <div class="info-arrow">‚Ä∫</div>
      </a>
      <div class="info-item">
        <div class="info-icon">üïê</div>
        <div><div class="info-lbl">–ß–∞—Å—ã —Ä–∞–±–æ—Ç—ã</div><div class="info-val">–ü–Ω‚Äì–ü—Ç 12:00‚Äì23:00 ¬∑ –°–±‚Äì–í—Å 11:00‚Äì00:00</div></div>
      </div>
      <a class="info-item" href="tel:+74951234567">
        <div class="info-icon">üìû</div>
        <div><div class="info-lbl">–¢–µ–ª–µ—Ñ–æ–Ω</div><div class="info-val">+7 (495) 123-45-67</div></div>
        <div class="info-arrow">‚Ä∫</div>
      </a>
      <div class="info-item">
        <div class="info-icon">‚≠ê</div>
        <div><div class="info-lbl">–†–µ–π—Ç–∏–Ω–≥</div><div class="info-val">4.9 ¬∑ Michelin Recommended 2024</div></div>
      </div>
    </div>
  </div>
  <div class="pb"></div>
</div>

<!-- MAPS MODAL -->
<div class="modal-overlay" id="mapsModal" onclick="if(event.target===this)this.classList.remove('show')">
  <div class="modal-box">
    <div class="modal-title">–û—Ç–∫—Ä—ã—Ç—å –≤ –∫–∞—Ä—Ç–∞—Ö</div>
    <div class="modal-sub">–ö—É–∑–Ω–µ—Ü–∫–∏–π –ú–æ—Å—Ç, 7, –ú–æ—Å–∫–≤–∞</div>
    <div class="modal-btns">
      <a class="map-btn yandex" href="https://yandex.ru/maps/?text=–ö—É–∑–Ω–µ—Ü–∫–∏–π+–ú–æ—Å—Ç+7+–ú–æ—Å–∫–≤–∞" target="_blank">üó∫ –Ø–Ω–¥–µ–∫—Å –ö–∞—Ä—Ç—ã</a>
      <a class="map-btn google" href="https://www.google.com/maps/search/–ö—É–∑–Ω–µ—Ü–∫–∏–π+–ú–æ—Å—Ç+7+–ú–æ—Å–∫–≤–∞" target="_blank">üåê Google Maps</a>
      <button class="modal-cancel" onclick="document.getElementById('mapsModal').classList.remove('show')">–û—Ç–º–µ–Ω–∞</button>
    </div>
  </div>
</div>

<!-- TOAST -->
<div class="toast" id="toast"></div>

<!-- SUCCESS -->
<div class="success-overlay" id="successOverlay">
  <div class="sparks" id="sparks"></div>
  <div class="s-rings"><div class="s-ring"></div><div class="s-ring"></div><div class="s-ring"></div><div class="s-center" id="sIcon">‚úì</div></div>
  <div class="s-title" id="sTitle"></div>
  <div class="s-text" id="sText"></div>
  <div class="s-cta"><button class="cta-btn" onclick="closeSuccess()">–û—Ç–ª–∏—á–Ω–æ!</button></div>
</div>

<script>
/* ‚ïê‚ïê‚ïê CONFIG ‚ïê‚ïê‚ïê
   BASE_URL: –∞–¥—Ä–µ—Å —Ç–≤–æ–µ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞.
   –ü—Ä–∏ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ (ngrok/localhost) ‚Äî url ngrok –∏–ª–∏ http://localhost:5000
   –ü—Ä–∏ –¥–µ–ø–ª–æ–µ –Ω–∞ Railway/VPS ‚Äî url —Å–µ—Ä–≤–µ—Ä–∞
*/
const BASE_URL = window.location.origin; // –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –±–µ—Ä—ë—Ç —Ç–µ–∫—É—â–∏–π –¥–æ–º–µ–Ω

const ALL_TIMES = ['12:00','13:00','14:00','15:00','17:00','18:00','19:00','20:00','21:00','22:00'];
const CAT_LABELS = {all:'–í—Å—ë', starters:'–ó–∞–∫—É—Å–∫–∏', mains:'–û—Å–Ω–æ–≤–Ω—ã–µ', desserts:'–î–µ—Å–µ—Ä—Ç—ã', drinks:'–ù–∞–ø–∏—Ç–∫–∏'};

/* ‚ïê‚ïê‚ïê STATE ‚ïê‚ïê‚ïê */
let menuData = {};       // {category: [{id,name,desc,price,img},...]}
let cart = {};
let activeCat = 'all';
let selGuests = 2;
let selTime = '';
let pendingData = null;
let bookedTimes = [];

/* ‚ïê‚ïê‚ïê TELEGRAM ‚ïê‚ïê‚ïê */
const tg = window.Telegram?.WebApp;
if (tg) { tg.ready(); tg.expand(); }

/* ‚ïê‚ïê‚ïê NAV ‚ïê‚ïê‚ïê */
const navEl = document.getElementById('nav');
const glow  = document.getElementById('navGlow');
function moveGlow(btn) {
  const r = btn.getBoundingClientRect(), nr = navEl.getBoundingClientRect();
  glow.style.left  = (r.left - nr.left) + 'px';
  glow.style.width = r.width + 'px';
}
document.querySelectorAll('.nav-btn').forEach(btn => {
  btn.addEventListener('click', () => {
    document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active'));
    document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
    btn.classList.add('active');
    document.getElementById('page-' + btn.dataset.page).classList.add('active');
    moveGlow(btn);
    if (btn.dataset.page === 'order') renderOrder();
    if (btn.dataset.page === 'booking') loadBookedTimes();
    window.scrollTo({top:0,behavior:'smooth'});
  });
});
setTimeout(() => moveGlow(document.querySelector('.nav-btn.active')), 50);

/* ‚ïê‚ïê‚ïê LOAD MENU FROM API ‚ïê‚ïê‚ïê */
async function loadMenu() {
  try {
    const res = await fetch(`${BASE_URL}/api/menu`);
    const json = await res.json();
    if (json.ok) {
      menuData = json.menu;
      buildCats();
      buildMenu();
    }
  } catch (e) {
    document.getElementById('menuContent').innerHTML =
      '<div class="empty-state"><div class="empty-icon">‚ö†Ô∏è</div><div class="empty-txt">–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å –º–µ–Ω—é.<br>–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ.</div></div>';
  }
}

/* ‚ïê‚ïê‚ïê CATEGORIES ‚ïê‚ïê‚ïê */
function buildCats() {
  const allCats = ['all', ...Object.keys(menuData)];
  const wrap = document.getElementById('catWrap');
  wrap.innerHTML = allCats.map(c =>
    `<button class="cat-pill ${c===activeCat?'active':''}" data-cat="${c}"><span>${CAT_LABELS[c]||c}</span></button>`
  ).join('');
  wrap.querySelectorAll('.cat-pill').forEach(b => b.addEventListener('click', () => {
    activeCat = b.dataset.cat; buildCats(); buildMenu();
  }));
}

/* ‚ïê‚ïê‚ïê BUILD MENU ‚ïê‚ïê‚ïê */
function buildMenu() {
  let items = [];
  if (activeCat === 'all') {
    Object.values(menuData).forEach(arr => items.push(...arr));
  } else {
    items = menuData[activeCat] || [];
  }

  if (!items.length) {
    document.getElementById('menuContent').innerHTML =
      '<div class="empty-state"><div class="empty-icon">üçΩ</div><div class="empty-txt">–í —ç—Ç–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏<br>–ø–æ–∫–∞ –Ω–µ—Ç –±–ª—é–¥</div></div>';
    return;
  }

  const grid = document.createElement('div');
  grid.className = 'menu-grid';
  grid.innerHTML = items.map((item, i) => `
    <div class="mcard" id="mcard_${item.id}" style="animation-delay:${i*45}ms">
      <div class="mcard-img-wrap">
        <img class="mcard-img" data-src="${item.image_url}" alt="${item.name}"/>
        <div class="mcard-img-overlay"></div>
      </div>
      <div class="mcard-body">
        <div>
          <div class="mcard-name">${item.name}</div>
          <div class="mcard-desc">${item.description}</div>
        </div>
        <div class="mcard-foot">
          <div class="mcard-price">${item.price.toLocaleString()} ‚ÇΩ</div>
          <div class="mcard-action" id="action_${item.id}"></div>
        </div>
      </div>
    </div>`).join('');

  document.getElementById('menuContent').replaceChildren(grid);

  // Lazy load images
  grid.querySelectorAll('.mcard-img').forEach(img => {
    img.onload = () => img.classList.add('loaded');
    img.src = img.dataset.src;
  });

  // Intersection observer
  const obs = new IntersectionObserver(entries => {
    entries.forEach(e => { if (e.isIntersecting) { e.target.classList.add('in'); obs.unobserve(e.target); }});
  }, {threshold:0.04});
  grid.querySelectorAll('.mcard').forEach(c => obs.observe(c));

  items.forEach(item => renderAction(item.id));
}

function getAllItems() {
  let all = [];
  Object.values(menuData).forEach(arr => all.push(...arr));
  return all;
}

function getItemById(id) {
  return getAllItems().find(m => m.id === id);
}

function renderAction(id) {
  const el = document.getElementById('action_' + id);
  if (!el) return;
  const qty = cart[id] || 0;
  if (qty === 0) {
    el.innerHTML = `<button class="add-btn" onclick="addItem(${id},this)"><span class="plus">+</span></button>`;
  } else {
    el.innerHTML = `<div class="qty-ctrl">
      <button class="qty-btn" onclick="removeItem(${id})">‚àí</button>
      <span class="qty-num" id="num_${id}">${qty}</span>
      <button class="qty-btn" onclick="addItem(${id})">+</button>
    </div>`;
  }
}

function addItem(id, btn) {
  cart[id] = (cart[id] || 0) + 1;
  updateBadge(); renderAction(id);
  const num = document.getElementById('num_' + id);
  if (num) { num.classList.remove('bump'); void num.offsetWidth; num.classList.add('bump'); }
  const item = getItemById(id);
  if (item) showToast('‚ú¶  ' + item.name);
  if (btn) addRipple(btn, null);
}
function removeItem(id) {
  if (!cart[id]) return;
  cart[id]--;
  if (!cart[id]) delete cart[id];
  updateBadge(); renderAction(id);
}
function updateBadge() {
  const total = Object.values(cart).reduce((a,b) => a+b, 0);
  const badge = document.getElementById('cartBadge');
  if (total > 0) { badge.style.display=''; badge.textContent=total; badge.classList.remove('pop'); void badge.offsetWidth; badge.classList.add('pop'); }
  else badge.style.display = 'none';
}

/* ‚ïê‚ïê‚ïê LOAD BOOKED TIMES FROM API ‚ïê‚ïê‚ïê */
async function loadBookedTimes() {
  const date = document.getElementById('bDate').value;
  if (!date) return;
  try {
    const res = await fetch(`${BASE_URL}/api/booked-times?date=${date}`);
    const json = await res.json();
    if (json.ok) bookedTimes = json.booked;
  } catch (e) {
    bookedTimes = [];
  }
  renderTimeGrid();
}

/* ‚ïê‚ïê‚ïê TIME GRID ‚ïê‚ïê‚ïê */
function renderTimeGrid() {
  const grid = document.getElementById('timeGrid');
  grid.innerHTML = ALL_TIMES.map(t => {
    const isBusy = bookedTimes.includes(t);
    const isSel  = t === selTime && !isBusy;
    const cls    = isBusy ? 'busy' : isSel ? 'sel' : 'free';
    const stat   = isBusy ? '–∑–∞–Ω—è—Ç–æ' : isSel ? '–≤—ã–±—Ä–∞–Ω–æ' : '—Å–≤–æ–±–æ–¥–Ω–æ';
    return `<button class="t-btn ${cls}" onclick="selectTime('${t}')" ${isBusy?'disabled':''}>
      <span class="tt">${t}</span><span class="ts">${stat}</span>
    </button>`;
  }).join('');
}

function selectTime(t) {
  if (bookedTimes.includes(t)) return;
  selTime = t; renderTimeGrid();
}

/* ‚ïê‚ïê‚ïê GUESTS ‚ïê‚ïê‚ïê */
function buildGuests() {
  document.getElementById('guestGrid').innerHTML = [1,2,3,4,5,6].map(n =>
    `<button class="g-btn ${n===selGuests?'active':''}" onclick="selGuest(${n})">${n}</button>`
  ).join('');
}
function selGuest(n) { selGuests = n; buildGuests(); }

/* ‚ïê‚ïê‚ïê PHONE MASK ‚ïê‚ïê‚ïê */
function initPhoneMask(inputId) {
  const inp = document.getElementById(inputId);
  if (!inp) return;
  inp.addEventListener('input', () => {
    let v = inp.value.replace(/\D/g,'');
    if (v.startsWith('7') || v.startsWith('8')) v = v.slice(1);
    v = v.slice(0,10);
    let mask = '';
    if (v.length > 0) mask = '(' + v.slice(0,3);
    if (v.length >= 3) mask += ') ' + v.slice(3,6);
    else if (v.length > 0) mask += v.slice(3);
    if (v.length >= 6) mask += '-' + v.slice(6,8);
    if (v.length >= 8) mask += '-' + v.slice(8,10);
    inp.value = mask;
  });
}

/* ‚ïê‚ïê‚ïê SUBMIT BOOKING ‚ïê‚ïê‚ïê */
function submitBooking(e) {
  addRipple(e.currentTarget, e);
  const name    = document.getElementById('bName').value.trim();
  const phone   = document.getElementById('bPhone').value.trim();
  const date    = document.getElementById('bDate').value;
  const comment = document.getElementById('bComment').value.trim();
  if (!name || !phone || !date || !selTime) { showToast('‚ö†  –ó–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è'); return; }

  const data = {type:'booking', name, phone:'+7'+phone.replace(/\D/g,''), date, time:selTime, guests:selGuests, comment};
  pendingData = data;

  const months = ['—è–Ω–≤','—Ñ–µ–≤','–º–∞—Ä','–∞–ø—Ä','–º–∞–π','–∏—é–Ω','–∏—é–ª','–∞–≤–≥','—Å–µ–Ω','–æ–∫—Ç','–Ω–æ—è','–¥–µ–∫'];
  const [y,m,d_] = date.split('-');
  showSuccess('ü•Ç', '–ë—Ä–æ–Ω—å –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∞!', `–°—Ç–æ–ª–∏–∫ –Ω–∞ ${selGuests} ${gw(selGuests)}\n${+d_} ${months[+m-1]} ¬∑ ${selTime}\n\n–ú—ã —Å–≤—è–∂–µ–º—Å—è –¥–ª—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è`);
  selTime = '';
  bookedTimes.push(selTime); // optimistic update ‚Äî –æ–±–Ω–æ–≤–∏—Ç—Å—è –ø—Ä–∏ —Å–ª–µ–¥—É—é—â–µ–º –æ—Ç–∫—Ä—ã—Ç–∏–∏
}

/* ‚ïê‚ïê‚ïê ORDER ‚ïê‚ïê‚ïê */
function renderOrder() {
  const el  = document.getElementById('orderContent');
  const keys = Object.keys(cart).map(Number);
  if (!keys.length) {
    el.innerHTML = `<div class="empty-state"><div class="empty-icon">üçΩ</div><div class="empty-txt">–ö–æ—Ä–∑–∏–Ω–∞ –ø—É—Å—Ç–∞<br>–í—ã–±–µ—Ä–∏—Ç–µ –±–ª—é–¥–∞ –∏–∑ –º–µ–Ω—é</div></div>`;
    return;
  }
  let sub = 0;
  const rows = keys.map(id => {
    const m = getItemById(id); if(!m) return '';
    const tot = m.price * cart[id]; sub += tot;
    return `<div class="oitem"><img class="oitem-img" src="${m.image_url}"/>
      <div class="oitem-info"><div class="oitem-name">${m.name}</div><div class="oitem-qty">${cart[id]} √ó ${m.price.toLocaleString()} ‚ÇΩ</div></div>
      <div class="oitem-price">${tot.toLocaleString()} ‚ÇΩ</div></div>`;
  }).join('');
  const svc = Math.round(sub*.1), total = sub+svc;
  el.innerHTML = `<div class="order-list">${rows}</div>
  <div class="order-summary">
    <div class="sum-row"><span>–°—É–º–º–∞</span><span>${sub.toLocaleString()} ‚ÇΩ</span></div>
    <div class="sum-row"><span>–°–µ—Ä–≤–∏—Å–Ω—ã–π —Å–±–æ—Ä (10%)</span><span>${svc.toLocaleString()} ‚ÇΩ</span></div>
    <div class="sum-row total"><span>–ò—Ç–æ–≥–æ</span><span>${total.toLocaleString()} ‚ÇΩ</span></div>
  </div>
  <div style="padding:16px 20px 0"><button class="cta-btn" onclick="submitOrder(event)">–û—Ñ–æ—Ä–º–∏—Ç—å –∑–∞–∫–∞–∑</button></div>`;
}

function submitOrder(e) {
  addRipple(e.currentTarget, e);
  const keys = Object.keys(cart).map(Number);
  if (!keys.length) return;
  const items = keys.map(id => { const m=getItemById(id); return `${m.name} √ó ${cart[id]}`; });
  const total = keys.reduce((s,id) => s + getItemById(id).price * cart[id], 0);
  pendingData = {type:'order', items, total};
  cart = {}; updateBadge();
  showSuccess('üçΩ', '–ó–∞–∫–∞–∑ –ø—Ä–∏–Ω—è—Ç!', `–í–∞—à –∑–∞–∫–∞–∑ –ø–µ—Ä–µ–¥–∞–Ω –Ω–∞ –∫—É—Ö–Ω—é\n–û–∂–∏–¥–∞–π—Ç–µ 30‚Äì40 –º–∏–Ω—É—Ç\n\n–°—É–º–º–∞: ${total.toLocaleString()} ‚ÇΩ`);
}

/* ‚ïê‚ïê‚ïê MY BOOKINGS (client search + cancel) ‚ïê‚ïê‚ïê */
async function searchBookings(e) {
  addRipple(e.currentTarget, e);
  const phone = '+7' + document.getElementById('searchPhone').value.replace(/\D/g,'');
  if (phone.length < 5) { showToast('–í–≤–µ–¥–∏—Ç–µ –Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞'); return; }

  const res_el = document.getElementById('bookingResults');
  res_el.innerHTML = '<div class="loader"><div class="loader-dot"></div><div class="loader-dot"></div><div class="loader-dot"></div></div>';

  try {
    const res = await fetch(`${BASE_URL}/api/my-bookings?phone=${encodeURIComponent(phone)}`);
    const json = await res.json();
    if (!json.ok || !json.bookings.length) {
      res_el.innerHTML = '<div class="empty-state"><div class="empty-icon">üîç</div><div class="empty-txt">–ë—Ä–æ–Ω–µ–π –Ω–µ –Ω–∞–π–¥–µ–Ω–æ.<br>–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞.</div></div>';
      return;
    }
    const months = ['—è–Ω–≤','—Ñ–µ–≤','–º–∞—Ä','–∞–ø—Ä','–º–∞–π','–∏—é–Ω','–∏—é–ª','–∞–≤–≥','—Å–µ–Ω','–æ–∫—Ç','–Ω–æ—è','–¥–µ–∫'];
    res_el.innerHTML = json.bookings.map(b => {
      const [y,m,d_] = b.date.split('-');
      const dateStr = `${+d_} ${months[+m-1]} ${y}`;
      const isCancelled = b.status === 'cancelled';
      return `<div class="b-card ${isCancelled?'cancelled':''}" id="bcard_${b.id}">
        <div class="b-card-header">
          <div class="b-card-id">–ë—Ä–æ–Ω—å #${b.id}</div>
          <div class="b-status ${b.status}">${b.status==='confirmed'?'‚úÖ –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∞':'‚ùå –û—Ç–º–µ–Ω–µ–Ω–∞'}</div>
        </div>
        <div class="b-row"><span class="b-row-icon">üìÖ</span>${dateStr} –≤ ${b.time}</div>
        <div class="b-row"><span class="b-row-icon">üë•</span>${b.guests} ${gw(b.guests)}</div>
        ${b.comment ? `<div class="b-comment">üí¨ ${b.comment}</div>` : ''}
        ${!isCancelled ? `<button class="cancel-btn" onclick="cancelBooking(${b.id},'${phone}',this)">–û—Ç–º–µ–Ω–∏—Ç—å –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ</button>` : ''}
      </div>`;
    }).join('');
  } catch (err) {
    res_el.innerHTML = '<div class="empty-state"><div class="empty-icon">‚ö†Ô∏è</div><div class="empty-txt">–û—à–∏–±–∫–∞ —Å–µ—Ç–∏.<br>–ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–∑–∂–µ.</div></div>';
  }
}

async function cancelBooking(bookingId, phone, btn) {
  btn.disabled = true;
  btn.textContent = '–û—Ç–º–µ–Ω—è–µ–º‚Ä¶';
  try {
    const res = await fetch(`${BASE_URL}/api/cancel-booking`, {
      method: 'POST',
      headers: {'Content-Type':'application/json'},
      body: JSON.stringify({booking_id: bookingId, phone})
    });
    const json = await res.json();
    if (json.ok) {
      const card = document.getElementById('bcard_' + bookingId);
      if (card) {
        card.classList.add('cancelled');
        card.querySelector('.b-status').textContent = '‚ùå –û—Ç–º–µ–Ω–µ–Ω–∞';
        card.querySelector('.b-status').className = 'b-status cancelled';
        btn.remove();
      }
      showToast('‚úÖ –ë—Ä–æ–Ω—å –æ—Ç–º–µ–Ω–µ–Ω–∞');
      // –¢–∞–∫–∂–µ —É–≤–µ–¥–æ–º–ª—è–µ–º –±–æ—Ç–∞
      if (tg?.sendData) {
        tg.sendData(JSON.stringify({type:'cancel_booking', booking_id:bookingId}));
      }
    } else {
      btn.disabled = false;
      btn.textContent = '–û—Ç–º–µ–Ω–∏—Ç—å –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ';
      showToast('‚ö† –ù–µ —É–¥–∞–ª–æ—Å—å –æ—Ç–º–µ–Ω–∏—Ç—å. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–∑–∂–µ.');
    }
  } catch (e) {
    btn.disabled = false;
    btn.textContent = '–û—Ç–º–µ–Ω–∏—Ç—å –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ';
    showToast('‚ö† –û—à–∏–±–∫–∞ —Å–µ—Ç–∏');
  }
}

/* ‚ïê‚ïê‚ïê SEND TO BOT ‚ïê‚ïê‚ïê */
function sendToBot(data) {
  try {
    if (tg?.sendData) { tg.sendData(JSON.stringify(data)); }
    else {
      fetch(`${BASE_URL}/api/webapp-data`, {method:'POST', headers:{'Content-Type':'application/json'}, body:JSON.stringify(data)}).catch(()=>{});
    }
  } catch(e) { console.error(e); }
}

/* ‚ïê‚ïê‚ïê SUCCESS ‚ïê‚ïê‚ïê */
function showSuccess(icon, title, text) {
  document.getElementById('sIcon').textContent = icon;
  document.getElementById('sTitle').textContent = title;
  document.getElementById('sText').textContent = text;
  document.getElementById('successOverlay').classList.add('show');
  spawnSparks();
}
function closeSuccess() {
  document.getElementById('successOverlay').classList.remove('show');
  if (pendingData) { sendToBot(pendingData); pendingData = null; }
}
function spawnSparks() {
  const c = document.getElementById('sparks'); c.innerHTML = '';
  const cols = ['#c8a45a','#e2c07a','#f5dda0','#d4621a','#fff8e7'];
  const cx = window.innerWidth/2, cy = window.innerHeight/2;
  for (let i=0; i<32; i++) {
    const s = document.createElement('div'); s.className='spark';
    const ang=(i/32)*Math.PI*2, dist=70+Math.random()*160;
    Object.assign(s.style,{left:cx+'px',top:cy+'px',background:cols[i%cols.length],
      width:(2+Math.random()*5)+'px',height:(2+Math.random()*5)+'px',
      '--tx':(Math.cos(ang)*dist)+'px','--ty':(Math.sin(ang)*dist)+'px',
      '--dur':(.7+Math.random()*.7)+'s','--del':(Math.random()*.25)+'s'});
    c.appendChild(s);
  }
}

/* ‚ïê‚ïê‚ïê MAPS ‚ïê‚ïê‚ïê */
function openMaps(e) { e.preventDefault(); document.getElementById('mapsModal').classList.add('show'); }

/* ‚ïê‚ïê‚ïê TOAST ‚ïê‚ïê‚ïê */
let toastTm;
function showToast(msg) {
  const t=document.getElementById('toast'); t.textContent=msg; t.classList.add('show');
  clearTimeout(toastTm); toastTm=setTimeout(()=>t.classList.remove('show'),2300);
}

/* ‚ïê‚ïê‚ïê RIPPLE ‚ïê‚ïê‚ïê */
function addRipple(btn,e) {
  const r=document.createElement('span'); r.className='rpl';
  const rect=btn.getBoundingClientRect(), size=Math.max(btn.offsetWidth,btn.offsetHeight)*2;
  const x=e?e.clientX-rect.left-size/2:btn.offsetWidth/2-size/2;
  const y=e?e.clientY-rect.top-size/2:btn.offsetHeight/2-size/2;
  Object.assign(r.style,{width:size+'px',height:size+'px',left:x+'px',top:y+'px'});
  btn.appendChild(r); setTimeout(()=>r.remove(),600);
}

/* ‚ïê‚ïê‚ïê HELPERS ‚ïê‚ïê‚ïê */
function gw(n) { return n===1?'–≥–æ—Å—Ç—è':'–≥–æ—Å—Ç–µ–π'; }

/* ‚ïê‚ïê‚ïê INIT ‚ïê‚ïê‚ïê */
window.addEventListener('DOMContentLoaded', () => {
  const today = new Date().toISOString().split('T')[0];
  const dateEl = document.getElementById('bDate');
  dateEl.min = today; dateEl.value = today;
  dateEl.addEventListener('change', loadBookedTimes);

  initPhoneMask('bPhone');
  initPhoneMask('searchPhone');
  buildGuests();
  loadMenu();
  loadBookedTimes();
});
</script>
</body>
</html>
